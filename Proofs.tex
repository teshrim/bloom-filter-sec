\section{Proofs}
\begin{theorem}
Fix $n,k, m > 0$ and define a hash-based filter as in section \ref{sec:hbf}, except the hash functions are defined by $h_j(x) = \left( f_{K0}(x) + j\cdot g_{K1}(x)\right) \bmod m$. Let $Func(m,m)$ be the set of all functions $\rho \colon \calK \times \bits^m \sends \bits^m$. Let $B_1, B_2$ be 2 adversaries with keys $K_1, K_2 \getsr \calK$ attacking the PRF advantage of $F \colon \calK \times \bits^m \sends \bits^m$ and $A$ be another adversary attacking the false positive game of hash-based filters, then 
\begin{equation}
\AdvFPSecHash{B}{\distr{U}{n},A}  = 0.5\Big[\AdvPRF{F}{B_1} + \AdvPRF{F}{B_2}\Big] + 1-\epsilon, \nudge where \nudge \epsilon = (1-e^{-kn/m})^k
\end{equation}
Note: $\epsilon$ is the false positive error in the double hashing scheme given by Kirsch and Mitzenmacher \cite{xxx}
\end{theorem}

\begin{proof}
The proof of the theorem will use a game playing argument as shown in Fig. \ref{fig:Game}. In $\game{0}$, the hash functions are uniformly random functions sampled from $Func(m,m)$, whereas in $\game{1}$ and $\game{2}$, the hash functions are linear combinations of a PRF and a random function. It can be seen that, $\game{0}$ exactly simulates $\ExpFPSecHash{B}{A}$. So, $\AdvFPSecHash{B}{A}=\Prob{\game{0}(A)=1}$. Also, the probability of winning $\game{1}$ and $\game{2}$ are equal, i.e.,$\Prob{\game{1}(A)=1}=\Prob{\game{2}(A)=1}$. The hash functions in $\game{3}$ are linear combinations of 2 random functions or 2 PRF's. 

\begin{figure}[h]
\fpage{.9}{
\hpagessd{.5}{.5}
{
\underline{\game{0}(A)}\\
$h_1,h_2, \cdots, h_k \getsr Func(m,m)$\\
%$K \getsr \calK$\\
$S \getsr \distr{U}{n}$\\
$M \getsr \Rep^{h_1, \cdots, h_k}(S)$\\
$x \getsr A^{\QryOracle(\cdot)}(S)$\\
if $x \not\in S \wedge \Qry^{h_1, \cdots, h_k}(M,x)=1$ then\\
\nudge Ret 1\\
Ret 0\\\\\\
%
\oracle{$\QryOracle(x)$}\\
Ret $\Qry^{h_1, \cdots, h_k}(M,x)$
}
{
\underline{\game{1}(A)}\\
$K \getsr \calK$\\
$h_j(\cdot) \getsr F_K(\cdot)+j\calO_2(.), \nudge \mathrm{where} \nudge j \in [1,k]$\\
$S \getsr \distr{U}{n}$\\
$M \getsr \Rep^{h_1, \cdots, h_k}(S)$\\
$x \getsr A^{\QryOracle(\cdot)}(S)$\\
if $x \not\in S \wedge \Qry^{h_1, \cdots, h_k}(M,x)=1$ then\\
\nudge Ret 1\\
Ret 0\\\\
%
\oracle{$\QryOracle(x)$}\\
Ret $\Qry^{h_1, \cdots, h_k}(M,x)$
}
{
\underline{\game{2}(A)}\\
$K \getsr \calK$\\
$h_j = \calO_1(\cdot) + jF_K(\cdot), \nudge \mathrm{where} \nudge j \in [1,k]$\\
$S \getsr \distr{U}{n}$\\
$M \getsr \Rep^{h_1, \cdots, h_k}(S)$\\
$x \getsr A^{\QryOracle(\cdot)}(S)$\\
if $x \not\in S \wedge \Qry^{h_1, \cdots, h_k}(M,x)=1$ then\\
\nudge Ret 1\\
Ret 0\\\\\\
%
\oracle{$\QryOracle(x)$}\\
Ret $\Qry^{h_1, \cdots, h_k}(M,x)$
}
{
\underline{\game{3}(A)}\\
$h_j = \calO_1(\cdot) + j\calO_2(\cdot), \nudge \mathrm{where} \nudge j \in [1,k]$\\
$S \getsr \distr{U}{n}$\\
$M \getsr \Rep^{h_1, \cdots, h_k}(S)$\\
$x \getsr A^{\QryOracle(\cdot)}(S)$\\
if $x \not\in S \wedge \Qry^{h_1, \cdots, h_k}(M,x)=1$ then\\
\nudge Ret 1\\
Ret 0\\\\\\\\
%
\oracle{$\QryOracle(x)$}\\
Ret $\Qry^{h_1, \cdots, h_k}(M,x)$
}
}
\caption{Game playing argument}\label{fig:Game}
\end{figure}

\begin{eqnarray*}
\Prob{\game{3}(A)=1} &=&\frac{1}{4}\Prob{\game{3}(A)=1|b_1=0, b_2=0} + \frac{1}{4}\Prob{\game{3}(A)=1|b_1=0, b_2=1}\\
& + & \frac{1}{4}\Prob{\game{3}(A)=1|b_1=1, b_2=0}+ \frac{1}{4}\Prob{\game{3}(A)=1|b_1=1, b_2=1}\\
& = & \frac{1}{4}\Prob{\game{0}(A)=1} + \frac{1}{4}\Prob{\game{2}(A)=1}\\
&\nudge + & \frac{1}{4}\Prob{\game{3}(A)=1} + \frac{1}{4}\Prob{\game{2}(A)=1|b=1}\\
& = & \frac{1}{4}\Prob{\game{0}(A)=1} + \frac{1}{4}\Prob{\game{2}(A)=1}\\
&\nudge + & \frac{1}{4}\Prob{\game{2}(A)=1} + \frac{1}{4}\Prob{\game{2}(A)=1|b=1}\\
& = & \frac{1}{4}\Prob{\game{0}(A)=1} + \frac{1}{2}\Prob{\game{2}(A)=1}\\
&\nudge + & \frac{1}{4}\Prob{\game{2}(A)=1|b=1}\\
& = & \frac{1}{4}\Prob{\game{0}(A)=1} + \frac{1}{2}\Big[\frac{1}{2}\Prob{\game{2}(A)=1|b=0}\\
	& \nudge + & \frac{1}{2}\Prob{\game{2}(A)=1|b=1}\Big] + \frac{1}{4}\Prob{\game{2}(A)=1|b=1}\\
& = & \frac{1}{4}\Prob{\game{0}(A)=1} + \frac{1}{4}\Prob{\game{0}(A)=1}\\
& \nudge + & \frac{1}{4}\Prob{\game{2}(A)=1|b=1} + \frac{1}{4}\Prob{\game{2}(A)=1|b=1}\\
& = & \frac{1}{2}\Prob{\game{0}(A)=1} + \frac{1}{2}\Prob{\game{2}(A)=1|b=1}
\end{eqnarray*}
 
The PRF-adversary $B$ simulates $\game{3}(A)$ as shown in Fig. \ref{fig:AdvB}. 
\begin{figure}[h]
\centering
\fpage{0.6}{
\hpagess{0.5}{0.2}
{
$\experimentv{Adversary \nudge B^{\calO}:}$\\
$d \getsr \bits$\\
if $d=0$\\
$\nudge \calO_1 \gets \calO$\\
$\nudge K \getsr \calK$\\
$\nudge \rho \getsr Func(m,m)$\\
$\nudge c \getsr \bits$\\
$\nudge$if $c=0$\\
$\nudge \nudge \calO_2 \gets \rho$\\
$\nudge$else\\
$\nudge \nudge \calO_2 \gets F_K$\\
Run $\game{3}$\\
When $A$ asks $\QryOracle(x)$:\\
$\nudge$ Ret $\Qry^{h_1, \cdots, h_k}(M,x^{'})$\\
When $A$ halts with output $x^{'}$: \\
if $x^{'} \not\in S \wedge \Qry^{h_1, \cdots, h_k}(M,x^{'})=1$ then\\
$\nudge$ Ret 1\\
Ret 0
}
{
\vspace{.6cm}
if $d=1$\\
$\nudge \calO_2 \gets \calO$\\
$\nudge K \getsr \calK$\\
$\nudge \rho \getsr Func(m,m)$\\
$\nudge c \getsr \bits$\\
$\nudge$if $c=0$\\
$\nudge \nudge \calO_1 \gets \rho$\\
$\nudge$else\\
$\nudge \nudge \calO_1 \gets F_K$\\
}
}
\caption{Adversary $B$ simulating $\game{3}$}\label{fig:AdvB}
\end{figure}

$B$ exactly simulates \game{3}(A).
\setlength{\mathindent}{1pt}
\begin{eqnarray*}
\Prob{\ExpPRF{F}{B} = 1} &=&  \Prob{\game{3}(A)=1}\\
 &=& \frac{1}{2}\Prob{\game{0}(A)=1} + \frac{1}{2}\Prob{\game{2}(A)=1|b=1}\\
 &=&  \frac{1}{2}\Prob{\ExpFPSecHash{B}{A}=1} + \frac{1}{2}\epsilon\\
 & \mathrm{where}& \epsilon = (1-e^{-kn/m})^k = \text{FP-error in double hashing scheme}
\end{eqnarray*}
\setlength{\mathindent}{1pt}
\begin{eqnarray*}
\Prob{\ExpPRF{F}{B} = 1|d=1} &= \Prob{\ExpPRF{F}{B_1} = 1}\\
\Prob{\ExpPRF{F}{B} = 1|d=0} &= \Prob{\ExpPRF{F}{B_2} = 1}
\end{eqnarray*}
\setlength{\mathindent}{1pt}
\begin{eqnarray*}
\Prob{\ExpPRF{F}{B} = 1} &=& \frac{1}{2}\Prob{\ExpPRF{F}{B} = 1|d=1}  + \frac{1}{2}\Prob{\ExpPRF{F}{B} = 1|d=0}\\
 &=&  \frac{1}{2}\Big[\Prob{\ExpPRF{F}{B_1} = 1} + \Prob{\ExpPRF{F}{B_2} = 1}\Big]
\end{eqnarray*}
\setlength{\mathindent}{1pt}
\begin{flalign*}
\frac{1}{2}\Big[\Prob{\ExpPRF{F}{B_1} = 1} &+ \Prob{\ExpPRF{F}{B_2} = 1}\Big] = \frac{1}{2}\Prob{\ExpFPSecHash{B}{A}=1} + \frac{1}{2}\epsilon\\
2\Prob{\ExpPRF{F}{B_1} = 1}-1 &+ 2\Prob{\ExpPRF{F}{B_2} = 1}-1  = 2\Big[\Prob{\ExpFPSecHash{B}{A}=1} + \epsilon -1\Big]\\
\frac{1}{2}\Big[\AdvPRF{B_1}{A} &+ \AdvPRF{B_2}{A}\Big]  =  \AdvFPSecHash{B}{A} + \epsilon -1\\
\AdvFPSecHash{B}{A}  &=  \frac{1}{2}\Big[\AdvPRF{B_1}{A} + \AdvPRF{B_2}{A}\Big] + \Big[1-\epsilon\Big]
\end{flalign*}

\end{proof}



